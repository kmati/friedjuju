!function e(n,r,t){function i(o,a){if(!r[o]){if(!n[o]){var s="function"==typeof require&&require;if(!a&&s)return s(o,!0);if(d)return d(o,!0);var l=new Error("Cannot find module '"+o+"'");throw l.code="MODULE_NOT_FOUND",l}var u=r[o]={exports:{}};n[o][0].call(u.exports,function(e){var r=n[o][1][e];return i(r?r:e)},u,u.exports,e,n,r,t)}return r[o].exports}for(var d="function"==typeof require&&require,o=0;o<t.length;o++)i(t[o]);return i}({1:[function(e,n,r){function t(e,n,r,i){if(this.id=e,this.value=n,this.index=r,this.children=[],i)if(i instanceof Array)for(var d=0;d<i.length;d++)this.children.push(i[d]);else{if(!(i instanceof t))throw new Error("Invalid children passed into Token constructor. Token #"+this.id);this.children.push(i)}}t.prototype.addChild=function(e){if(!(e instanceof t))throw new Error("Invalid Token being added to Token #"+this.id+"\n-> childToken = "+e.toString());this.children.push(e)},t.Literal="Literal","undefined"!=typeof n&&(n.exports=t)},{}],2:[function(e,n,r){function t(e,n){e instanceof Array||(e=[e]),this.tokenIds=e,this.fnHandler=n}var i={subscriptions:[],getSubscriptionsForToken:function(e){var n=[];return this.subscriptions.forEach(function(r){r.tokenIds.indexOf(e.id)>-1&&n.push(r)}),n},emit:function(e,n){this.getSubscriptionsForToken(n).forEach(function(e){e.fnHandler(n)})}},d={traverse:function(e){var n=i.getSubscriptionsForToken(e);n.length>0&&i.emit(n,e);for(var r=0;r<e.children.length;r++){var t=e.children[r];this.traverse(t)}},subscribe:function(e,n){var r=new t(e,n);i.subscriptions.push(r)}};"undefined"!=typeof n&&(n.exports=d)},{}],3:[function(e,n,r){var t=e("./Token.js"),i=e("./parserUtilsRestricted.js"),d=e("./parserUtilsExtended.js");for(var o in d)t[o]=o;var a={parseExtended:function(e){var n=0,r=d.Expression(e,n);if(r.newIndex<e.length)throw new Error("Unparsed characters exist at the end of the expression: "+e.substr(r.newIndex));return r},parseRestricted:function(e){var n=0,r=i.Expression(e,n);if(r.newIndex<e.length)throw new Error("Unparsed characters exist at the end of the expression: "+e.substr(r.newIndex));return r}};"undefined"!=typeof n&&(n.exports=a)},{"./Token.js":1,"./parserUtilsExtended.js":5,"./parserUtilsRestricted.js":6}],4:[function(e,n,r){var t=e("./Token.js"),i={checkMatch:function(e,n,r){return r>=e.length?void 0:e.substr(r,n.length)===n?{newIndex:r+n.length,token:new t(t.Literal,n,r)}:void 0},exactlyText:function(e,n,r,i){if(!(n>=e.length)){var d=this.checkMatch(e,r,n);if(d)return{newIndex:n+r.length,token:new t(i,e.substr(n,r.length),n)}}},repeat0Plus:function(e,n,r,i){if(!(n>=e.length)){for(var d=n,o=new t(t[r],"",n);n<e.length&&(ret=i[r](e,n),ret);)o.addChild(ret.token),n=ret.newIndex;return o.value=e.substring(d,n),{newIndex:n,token:o}}},repeat1Plus:function(e,n,r,i){if(!(n>=e.length)){var d=n,o=new t(t[r],"",n),a=i[r](e,n);if(a){for(o.addChild(a.token),n=a.newIndex;n<e.length&&(a=i[r](e,n));)o.addChild(a.token),n=a.newIndex;return o.value=e.substring(d,n),{newIndex:n,token:o}}}},onlyRepeat1Plus:function(e,n,r,i,d){if(!(n>=e.length)){var o=n,a=new t(d,"",n),s=this.repeat1Plus(e,n,r,i);return s&&(n=s.newIndex,a.addChild(s.token)),a.children.length>0?(a.value=e.substring(o,n),{newIndex:n,token:a}):void 0}},onlyRepeat0Plus:function(e,n,r,i,d){if(!(n>=e.length)){var o=n,a=new t(d,"",n),s=this.repeat0Plus(e,n,r,i);return s&&(n=s.newIndex,a.addChild(s.token)),a.children.length>0?(a.value=e.substring(o,n),{newIndex:n,token:a}):void 0}},or:function(e,n,r,i,d){if(!(n>=e.length)){for(var o=n,a=void 0,s=-1,l=0;l<r.length;l++){var u=r[l],f=i[u](e,n);f&&s<f.newIndex&&(a=f.token,s=f.newIndex)}if(a){n=s;var h=new t(d,e.substring(o,n),n,a);return{newIndex:n,token:h}}}},exactlyOne:function(e,n,r,i,d){if(!(n>=e.length)){var o=n,a=new t(d,"",n),s=i[r](e,n);return s?(n=s.newIndex,a.addChild(s.token),a.value=e.substring(o,n),{newIndex:n,token:a}):void 0}},seq:function(e,n,r,i,d){if(!(n>=e.length)){for(var o=n,a=new t(d,"",n),s=0;s<r.length;s++){var l=r[s],u=i[l](e,n);if(!u)return;n=u.newIndex,a.addChild(u.token)}return a.children.length>0?(a.value=e.substring(o,n),{newIndex:n,token:a}):void 0}}};"undefined"!=typeof n&&(n.exports=i)},{"./Token.js":1}],5:[function(e,n,r){var t=e("./Token.js"),i=e("./parserCommonFunctions.js"),d=e("./parserUtilsRestricted.js"),o={ExpressionPiece:function(e,n){return i.or(e,n,["Wildcard","SingleObjectPlaceholder","NumberPrefixedElement","Attribute","Element","StringElement"],this,"ExpressionPiece")},Attribute:function(e,n){if(!(n>=e.length)){var r=n,d=i.checkMatch(e,"@",n);if(d){n=d.newIndex;var o=i.repeat1Plus(e,n,"Char",this);if(o)return n=o.newIndex,{newIndex:o.newIndex,token:new t(t.Attribute,e.substring(r,n),r,[d.token,o.token])}}}},BoundedAttributeExpression:function(e,n){if(!(n>=e.length)){var r=n,d=new t(t.BoundedAttributeExpression,"",n),o=i.checkMatch(e,"[",n);if(o){n=o.newIndex,d.addChild(o.token);var a=this.Attribute(e,n);if(a){n=a.newIndex,d.addChild(a.token);var s=i.checkMatch(e,"=",n);if(s){n=s.newIndex,d.addChild(s.token);var l=i.repeat1Plus(e,n,"Char",this);if(l){n=l.newIndex,d.addChild(l.token);var u=i.checkMatch(e,"]",n);if(u)return n=u.newIndex,d.addChild(u.token),d.value=e.substring(r,n),{newIndex:n,token:d}}}}}}},BoundedAttributeDeclaration:function(e,n){if(!(n>=e.length)){var r=n,d=new t(t.BoundedAttributeDeclaration,"",n),o=i.checkMatch(e,"[",n);if(o){n=o.newIndex,d.addChild(o.token);var a=this.Attribute(e,n);if(a){n=a.newIndex,d.addChild(a.token);var s=i.checkMatch(e,"]",n);if(s)return n=s.newIndex,d.addChild(s.token),d.value=e.substring(r,n),{newIndex:n,token:d}}}}},BoundedElementExpression:function(e,n){if(!(n>=e.length)){var r=n,d=new t(t.BoundedElementExpression,"",n),o=i.checkMatch(e,"[",n);if(o){n=o.newIndex,d.addChild(o.token);var a=this.ElementName(e,n);if(a){n=a.newIndex,d.addChild(a.token);var s=i.checkMatch(e,"=",n);if(s){n=s.newIndex,d.addChild(s.token);var l=i.repeat1Plus(e,n,"Char",this);if(l){n=l.newIndex,d.addChild(l.token);var u=i.checkMatch(e,"]",n);if(u)return n=u.newIndex,d.addChild(u.token),d.value=e.substring(r,n),{newIndex:n,token:d}}}}}}},BoundedElementDeclaration:function(e,n){if(!(n>=e.length)){var r=n,d=new t(t.BoundedElementDeclaration,"",n),o=i.checkMatch(e,"[",n);if(o){n=o.newIndex,d.addChild(o.token);var a=this.ElementName(e,n);if(a){n=a.newIndex,d.addChild(a.token);var s=i.checkMatch(e,"]",n);if(s)return n=s.newIndex,d.addChild(s.token),d.value=e.substring(r,n),{newIndex:n,token:d}}}}},ArrayIndex:function(e,n){if(!(n>=e.length)){var r=n,d=new t(t.ArrayIndex,"",n),o=i.checkMatch(e,"[",n);if(o){n=o.newIndex,d.addChild(o.token);var a=i.checkMatch(e,"*",n);if(a){n=a.newIndex,d.addChild(a.token);var s=i.checkMatch(e,"]",n);if(s)return n=s.newIndex,d.addChild(s.token),d.value=e.substring(r,n),{newIndex:n,token:d};return}var l=i.repeat1Plus(e,n,"Digit",this);if(l){n=l.newIndex,d.addChild(l.token);var s=i.checkMatch(e,"]",n);if(s)return n=s.newIndex,d.addChild(s.token),d.value=e.substring(r,n),{newIndex:n,token:d}}}}},Element:function(e,n){if(!(n>=e.length)){var r=n,i=new t(t.Element,"",n),d=this.ElementName(e,n);if(d){n=d.newIndex,i.addChild(d.token);var o=this.ElementTail(e,n);return o&&(n=o.newIndex,i.addChild(o.token)),i.value=e.substring(r,n),{newIndex:n,token:i}}}},ElementName:function(e,n){if(!(n>=e.length)){var r=n,d=new t(t.ElementName,"",n),o=this.Char(e,n),a=this.Digit(e,n);if(!a&&o){var s=i.repeat1Plus(e,n,"Char",this);if(s)return n=s.newIndex,d.addChild(s.token),d.value=e.substring(r,n),{newIndex:n,token:d}}}},ElementTail:function(e,n){if(!(n>=e.length)){for(var r=n,i=new t(t.ElementTail,"",n);n<e.length;){var d=void 0,o=-1,a=this.BoundedAttributeExpression(e,n);a&&(d=a.token,o=a.newIndex);var s=this.BoundedAttributeDeclaration(e,n);s&&o<s.newIndex&&(d=s.token,o=s.newIndex);var l=this.BoundedElementExpression(e,n);l&&o<l.newIndex&&(d=l.token,o=l.newIndex);var u=this.BoundedElementDeclaration(e,n);u&&o<u.newIndex&&(d=u.token,o=u.newIndex);var f=this.ArrayIndex(e,n);if(f&&o<f.newIndex&&(d=f.token,o=f.newIndex),!d)break;n=o,i.addChild(d)}if(!(i.children.length<1))return i.value=e.substring(r,n),{newIndex:n,token:i}}},Char:function(e,n){if(!(n>=e.length)){var r=this.Dot(e,n);if(!r&&(r=this.Wildcard(e,n),!r&&(r=this.SingleObjectPlaceholder(e,n),!r))){var d=!0;if(["=","@","[","]"].forEach(function(t){r=i.checkMatch(e,t,n),r&&(d=!1)}),d)return{newIndex:n+1,token:new t(t.Char,e.substr(n,1),n)}}}},Wildcard:function(e,n){if(!(n>=e.length)){var r=n,d=new t(t.Wildcard,"",n),o=i.checkMatch(e,"*",n);if(o){n=o.newIndex,d.addChild(o.token);var a=this.ElementTail(e,n);return a&&(n=a.newIndex,d.addChild(a.token)),d.value=e.substring(r,n),{newIndex:n,token:d}}}},SingleObjectPlaceholder:function(e,n){if(!(n>=e.length)){var r=n,d=new t(t.SingleObjectPlaceholder,"",n),o=i.checkMatch(e,"?",n);if(o){n=o.newIndex,d.addChild(o.token);var a=this.ElementTail(e,n);return a&&(n=a.newIndex,d.addChild(a.token)),d.value=e.substring(r,n),{newIndex:n,token:d}}}}};for(var a in d)"ExpressionPiece"!==a&&"Attribute"!==a&&"Element"!==a&&"Wildcard"!==a&&"SingleObjectPlaceholder"!==a&&"Usage1Char"!==a&&(o[a]=d[a]);"undefined"!=typeof n&&(n.exports=o)},{"./Token.js":1,"./parserCommonFunctions.js":4,"./parserUtilsRestricted.js":6}],6:[function(e,n,r){var t=e("./Token.js"),i=e("./parserCommonFunctions.js"),d={Expression:function(e,n){if(!(n>=e.length)){var r=n,i=new t(t.Expression,"",n),d=this.ExpressionPiece(e,n);if(d){for(n=d.newIndex,i.addChild(d.token);n<e.length;){var o=n,a=[],s=this.Dot(e,n);if(!s)break;if(n=s.newIndex,a.push(s.token),d=this.ExpressionPiece(e,n),d&&(n=d.newIndex,a.push(d.token)),!a){n=o;break}for(var l=0;l<a.length;l++)i.addChild(a[l])}return i.children.length>0?(i.value=e.substring(r,n),{newIndex:n,token:i}):void 0}}},Dot:function(e,n){return i.exactlyText(e,n,".","Dot")},ExpressionPiece:function(e,n){return i.or(e,n,["NumberPrefixedElement","Attribute","Element","StringElement"],this,"ExpressionPiece")},Attribute:function(e,n){if(!(n>=e.length)){var r=n,d=i.checkMatch(e,"@",n);if(d){n=d.newIndex;var o=i.repeat1Plus(e,n,"Usage1Char",this);if(o)return n=o.newIndex,{newIndex:o.newIndex,token:new t(t.Attribute,e.substring(r,n),r,[d.token,o.token])}}}},Element:function(e,n){return i.onlyRepeat1Plus(e,n,"Usage1Char",this,"Element")},NumberPrefixedElement:function(e,n){if(!(n>=e.length)){var r=n,d=new t(t.NumberPrefixedElement,"",n),o=i.checkMatch(e,"$",n);if(o){d.addChild(o.token),n=o.newIndex;var a=i.repeat1Plus(e,n,"Digit",this);if(a){d.addChild(a.token),n=a.newIndex;var s=this.Element(e,n);if(s)return d.addChild(s.token),n=s.newIndex,d.value=e.substring(r,n),{newIndex:n,token:d}}}}},StringElement:function(e,n){return i.exactlyText(e,n,"$str","StringElement")},Digit:function(e,n){if(!(n>=e.length))for(var r=0;9>=r;r++){var d=i.checkMatch(e,r.toString(),n);if(d)return{newIndex:d.newIndex,token:new t(t.Digit,e.substr(n,1),n)}}},Usage1Char:function(e,n){if(!(n>=e.length)){var r=this.Dot(e,n);if(!r&&(r=this.Wildcard(e,n),!r&&(r=this.SingleObjectPlaceholder(e,n),!r))){var d=!0;if(["=","@","[","]"].forEach(function(t){r=i.checkMatch(e,t,n),r&&(d=!1)}),d)return{newIndex:n+1,token:new t(t.Usage1Char,e.substr(n,1),n)}}}},Wildcard:function(e,n){return i.exactlyText(e,n,"*","Wildcard")},SingleObjectPlaceholder:function(e,n){return i.exactlyText(e,n,"?","SingleObjectPlaceholder")}};"undefined"!=typeof n&&(n.exports=d)},{"./Token.js":1,"./parserCommonFunctions.js":4}],7:[function(e,n,r){var t=e("../expression-parser/ep.js"),i=e("../expression-parser/astEmitter.js"),d={yieldAll:function(e){if("object"!=typeof e)return[];if(e instanceof Array){var n=[];return e.forEach(function(e){for(var r=d.yieldAll(e),t=0;t<r.length;t++){var i=r[t];-1===n.indexOf(i)&&n.push(i)}}),n}var r=[e];for(var t in e){var i=e[t],o=this.yieldAll(i);o.forEach(function(e){-1===r.indexOf(e)&&r.push(e)})}return r},yieldImmediateChildren:function(e){if("object"!=typeof e)return[];if(e instanceof Array){var n=[];return e.forEach(function(r){for(var t in r){var i=r[t];"object"==typeof e&&n.push(i)}}),n}var r=[];for(var t in e)r.push(e[t]);return r},yieldElement:function(e,n){if(e instanceof Array){var r=[];return e.forEach(function(e){for(var t=d.yieldElement(e,n),i=0;i<t.length;i++)r.push(t[i])}),r}var t=[];for(var i in e)i===n&&t.push(e[i]);return t},yieldNumberedElement:function(e,n,r){if(e instanceof Array){var t=[];return e.forEach(function(e){for(var i=d.yieldNumberedElement(e,n,r),o=0;o<i.length;o++)t.push(i[o])}),t}var i=[];for(var o in e)(0===r&&o===n||o==="$"+r+n)&&i.push(e[o]);return i},yieldBoundedAttributeExpression:function(e,n,r){if(e instanceof Array){var t=[];return e.forEach(function(e){for(var i=d.yieldBoundedAttributeExpression(e,n,r),o=0;o<i.length;o++)t.push(i[o])}),t}var i=[];return e[n.value]===r.value&&i.push(e),i},yieldBoundedAttributeDeclaration:function(e,n){if(e instanceof Array){var r=[];return e.forEach(function(e){for(var t=d.yieldBoundedAttributeDeclaration(e,n),i=0;i<t.length;i++)r.push(t[i])}),r}var t=[];return"undefined"!=typeof e[n.value]&&t.push(e),t},yieldBoundedElementExpression:function(e,n,r){if(e instanceof Array){var t=[];return e.forEach(function(e){for(var i=d.yieldBoundedElementExpression(e,n,r),o=0;o<i.length;o++)t.push(i[o])}),t}var i=[];return e[n.value]===r.value&&i.push(e),i},yieldBoundedElementDeclaration:function(e,n){if(e instanceof Array){var r=[];return e.forEach(function(e){for(var t=d.yieldBoundedElementDeclaration(e,n),i=0;i<t.length;i++)r.push(t[i])}),r}var t=[];return"undefined"!=typeof e[n.value]&&t.push(e),t},yieldElementTail:function(e,n){for(var r=[],t=0;t<n.children.length;t++){var i=n.children[t];if("ArrayIndex"===i.id){var o=i.children[1],a=[];"*"===o.value?e.forEach(function(e){e.forEach(function(e){a.push(e)})}):e.forEach(function(e){var n=Number(o.value);n<e.length&&a.push(e[n])}),r=a}else if("BoundedAttributeExpression"===i.id){var s=i.children[1],l=i.children[3];r=d.yieldBoundedAttributeExpression(e,s,l)}else if("BoundedAttributeDeclaration"===i.id){var s=i.children[1];r=d.yieldBoundedAttributeDeclaration(e,s)}else if("BoundedElementExpression"===i.id){var u=i.children[1],f=i.children[3];r=d.yieldBoundedElementExpression(e,u,f)}else if("BoundedElementDeclaration"===i.id){var u=i.children[1];r=d.yieldBoundedElementDeclaration(e,u)}}return r}},o={query:function(e,n){var r=t.parseExtended(e),o=void 0;return i.subscribe(["ExpressionPiece"],function(e){var r=e.children[0];if("Wildcard"===r.id){if(o=o?d.yieldAll(o):d.yieldAll(n),o&&r.children.length>1){var t=r.children[1];o=d.yieldElementTail(o,t)}}else if("SingleObjectPlaceholder"===r.id){if(o){var i=[];o.forEach(function(e){for(var n=d.yieldImmediateChildren(e),r=0;r<n.length;r++)i.push(n[r])}),o=i}else o=d.yieldImmediateChildren(n);if(o&&r.children.length>1){var t=r.children[1];o=d.yieldElementTail(o,t)}}else if("Element"===r.id){var a=r.children[0];if(o){var i=[];o.forEach(function(e){for(var n=d.yieldElement(e,a.value),r=0;r<n.length;r++)i.push(n[r])}),o=i}else o=d.yieldElement(n,a.value);if(o&&r.children.length>1){var t=r.children[1];o=d.yieldElementTail(o,t)}}else if("NumberPrefixedElement"===r.id){var a=r.children[2].children[0],s=r.children[1];if(o){var i=[];o.forEach(function(e){for(var n=d.yieldNumberedElement(e,a.value,s.value),r=0;r<n.length;r++)i.push(n[r])}),o=i}else o=d.yieldNumberedElement(n,a.value,s.value)}!o||o.length<1}),i.traverse(r.token),o}};"undefined"!=typeof n&&(n.exports=o)},{"../expression-parser/astEmitter.js":2,"../expression-parser/ep.js":3}],8:[function(e,n,r){var t=e("./expressionQuery.js"),i=e("../json-to-markup/objectGraphCreator");"undefined"==typeof window&&(window={});var d={transform:function(e,n,r){var d=t.query(e.from,n);if(!d||d.length<1)return r;var o={};for(var a in r)o[a]=r[a];return 1===d.length?o[e.to]=d[0]:o[e.to]=d,i.expand(o)}},o=window.j2j={transform:function(e,n,r){return e instanceof Array||(e=[e]),r||(r={}),e.forEach(function(e){if("string"!=typeof e.from||"string"!=typeof e.to)throw new Error("The transform method must be passed an expression object with 'from' and 'to' properties or an array of such expression objects. Incorrect argument: "+JSON.stringify(e));r=d.transform(e,n,r)}),r},query:function(e,n){return t.query(e,n)}};"undefined"!=typeof n&&(n.exports=o)},{"../json-to-markup/objectGraphCreator":9,"./expressionQuery.js":7}],9:[function(e,n,r){var t=e("../expression-parser/ep.js"),i=e("../expression-parser/astEmitter.js"),d={create:function(e,n,r){var d=t.parseExtended(e),o=void 0,a=void 0,s=void 0,l=void 0,u=[];return i.subscribe(["ExpressionPiece"],function(e){o||(o=n);var t=e.children[0];if("NumberPrefixedElement"===t.id)a=t.value;else if("Attribute"===t.id)a=t.value;else{if("Element"!==t.id){if("StringElement"===t.id)return void(o.$str=r);throw new Error("Invalid ExpressionPiece for object graph creation | token.id = "+e.id)}if(t.children.length>1){a=t.children[0].value;var i=t.children[1],d=i.children[0];if("ArrayIndex"!==d.id)throw new Error("You can only index arrays (ArrayIndex) and cannot use bounded element or attribute expressions for object graph creation | ai.id = "+d.id);l=Number(d.children[1].value)}else a=t.value,l=void 0}var f={};if(u.push(a),o[a])if("undefined"!=typeof l){var h=o[a];h instanceof Array||(h=[h]),f=h[l],f||(f=h[l]={})}else f=o[a];else"undefined"!=typeof l?(o[a]=[],o[a][l]=f):o[a]=f;s=o,o=f}),i.traverse(d.token),s&&a?("undefined"==typeof l?s[a]=r:s[a][l]=r,u):void 0},getPair:function(e,n){for(var r=0;r<e.length;r++){var t=e[r];if(t.keyToDelete===n)return t}}},o={expand:function(e){var n={},r=[];for(var t in e)if(n[t]=e[t],t.indexOf(".")>-1){var i=e[t],o=d.create(t,e,i);o&&r.push({keyToDelete:t,keyToAdd:o[0]})}var a={};for(var t in e){var s=d.getPair(r,t);s?"undefined"==typeof a[s.keyToAdd]&&(a[s.keyToAdd]="__placeholder__"):a[t]=e[t]}r.forEach(function(n){delete e[n.keyToAdd]});for(var t in n)e[t]=n[t];return a}};"undefined"!=typeof n&&(n.exports=o)},{"../expression-parser/astEmitter.js":2,"../expression-parser/ep.js":3}]},{},[8]),"undefined"!=typeof module&&(module.exports=window.j2j);